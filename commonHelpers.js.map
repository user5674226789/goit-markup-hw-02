{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\n\nexport async function fetchImages(searchQueryResult, currentPage) {\n  try {\n    const BASE_URL = 'https://pixabay.com/api/';\n    const q = searchQueryResult;\n    const params = new URLSearchParams({\n      key: '42946583-b9bd64904b8b2d582b051d84e',\n      q: q,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      page: currentPage,\n    });\n    const url = `${BASE_URL}?${params}`;\n    const res = await axios.get(url);\n    return res.data;\n  } catch (error) {\n    iziToast.error({\n      message: 'Server error!',\n      position: 'topRight',\n    });\n  }\n}\n","import { gallery } from '../main';\n\nexport function renderGallery(data) {\n  const createMarkup = data.hits\n    .map(hit => {\n      const {\n        id,\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      } = hit;\n      return `\n    <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" id=${id} src=\"${webformatURL}\" alt=\"${tags}\"/>\n        </a>\n        <div class=\"gallery-item-info\">\n          <div class=\"item-info-atr\">\n          <h3>Likes</h3>\n          <p>${likes}</p>\n          </div>\n          <div class=\"item-info-atr\">\n          <h3>Views</h3>\n          <p>${views}</p>\n          </div>\n          <div class=\"item-info-atr\">\n          <h3>Comments</h3>\n          <p>${comments}</p>\n          </div>\n          <div class=\"item-info-atr\">\n          <h3>Downloads</h3>\n          <p>${downloads}</p>\n          </div>\n        </div>\n    </li>\n    `;\n    })\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', createMarkup);\n}\n","import iziToast from 'izitoast';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\nimport SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\nimport { fetchImages } from './js/pixabay-api';\r\nimport { renderGallery } from './js/render-functions';\r\n\r\nexport const gallery = document.querySelector('.gallery');\r\nconst searchForm = document.querySelector('#search-form');\r\nconst loadMoreBtn = document.querySelector('#load-more-btn');\r\nconst elemLoader = document.querySelector('#loader');\r\nlet searchQueryResult;\r\nlet totalPage;\r\nlet currentPage = 1;\r\nconst maxPage = 15;\r\nlet data;\r\n\r\nconst lightbox = new SimpleLightbox('.gallery a', {\r\n  captionsData: 'alt',\r\n  captionPosition: 'bottom',\r\n  captionDelay: 250,\r\n});\r\n\r\nsearchForm.addEventListener('submit', async event => {\r\n  event.preventDefault();\r\n  gallery.innerHTML = '';\r\n  currentPage = 1;\r\n  searchQueryResult = event.target.elements.query.value.trim();\r\n  if (searchQueryResult === '') {\r\n    iziToast.warning({\r\n      message: `The search field is empty. Please try again!`,\r\n      position: 'topRight',\r\n    });\r\n    searchForm.reset();\r\n    return;\r\n  }\r\n  try {\r\n    showElemLoader();\r\n    data = await fetchImages(searchQueryResult, currentPage);\r\n    totalPage = Math.ceil(data.totalHits / maxPage);\r\n    if (!data.hits.length) {\r\n      hideElemLoader();\r\n      iziToast.error({\r\n        message: 'Sorry, there are no images matching your search query. Please try again.',\r\n        position: 'topRight',\r\n      });\r\n      checkBtnStatus();\r\n    } else {\r\n      hideElemLoader();\r\n      renderGallery(data);\r\n      lightbox.refresh();\r\n      checkBtnStatus();\r\n    }\r\n  } catch (error) {\r\n    hideElemLoader();\r\n    iziToast.error({\r\n      message: `Error rendering gallery. Please try again!`,\r\n      position: 'topRight',\r\n    });\r\n  }\r\n  searchForm.reset();\r\n});\r\n\r\nloadMoreBtn.addEventListener('click', onLoadMoreBtn);\r\nasync function onLoadMoreBtn() {\r\n  currentPage++;\r\n  showElemLoader();\r\n  try {\r\n    data = await fetchImages(searchQueryResult, currentPage);\r\n    renderGallery(data);\r\n    lightbox.refresh();\r\n  } catch (error) {\r\n    iziToast.error({\r\n      position: 'topRight',\r\n      message: 'Error rendering next gallery images',\r\n    });\r\n  }\r\n  hideElemLoader();\r\n  onScroll();\r\n  checkBtnStatus();\r\n}\r\n\r\nfunction onScroll() {\r\n  const galleryCard = document.querySelector('.gallery-image');\r\n  const cardHeight = galleryCard.getBoundingClientRect().height;\r\n  window.scrollBy({\r\n    top: cardHeight * 2,\r\n    behavior: 'smooth',\r\n  });\r\n}\r\n\r\nfunction checkBtnStatus() {\r\n  if (currentPage >= totalPage) {\r\n    loadMoreBtn.classList.add('is-hidden');\r\n    iziToast.info({\r\n      message: \"We're sorry, there are no more images to load\",\r\n      position: 'topRight',\r\n    });\r\n  } else {\r\n    loadMoreBtn.classList.remove('is-hidden');\r\n  }\r\n}\r\n\r\nfunction hideElemLoader() {\r\n  elemLoader.classList.add('is-hidden');\r\n}\r\nfunction showElemLoader() {\r\n  elemLoader.classList.remove('is-hidden');\r\n}\r\n"],"names":["fetchImages","searchQueryResult","currentPage","BASE_URL","q","params","url","axios","iziToast","renderGallery","data","createMarkup","hit","id","webformatURL","largeImageURL","tags","likes","views","comments","downloads","gallery","searchForm","loadMoreBtn","elemLoader","totalPage","maxPage","lightbox","SimpleLightbox","event","showElemLoader","hideElemLoader","checkBtnStatus","onLoadMoreBtn","onScroll","cardHeight"],"mappings":"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"}